"use strict";const m=require("../checkFeed-DOTZWUmC.cjs"),c=["&_rss=1",".atom",".json",".rss",".xml","atom","atom.xml","atom/index.xml","feed","feed.atom","feed.json","feed.rss","feed.xml","feeds","feeds/","index.atom","index.rss","index.xml","rss","rss/","rss.xml","rss/index.xml","rss/news/rss.xml","rss/rss.php","rssfeed.rdf","rssfeed.xml","syndication/","blog-feed.xml","blog/atom","blog/feed","blog/feeds","blog/rss","blog?format=rss","weblog/atom","weblog/rss","?feed=atom","?feed=rss2","?format=feed","feed/atom/","feed/rdf/","feed/rss/","feed/rss2/","index.php?format=feed","wp-atom.php","wp-feed.php","wp-rdf.php","wp-rss.php","wp-rss2.php","articles/feed","atom/news/","latest.rss","latest/feed","news.xml","news/atom","news/rss","rss/articles/","rss/latest/","rss/news/","catalog.xml","catalog/feed","deals.xml","deals/feed","inventory.rss","inventory/feed","products.rss","products/atom","products/rss","promotions/feed","specials/feed","audio/feed","episodes.rss","episodes/feed","gallery.rss","media/feed","podcast.rss","podcast/atom","podcast/rss","podcasts/feed","shows/feed","video/feed","videos.rss","comments/feed","community/feed","discussions/feed","forum.rss","forum/atom","forum/rss","reviews/feed","agenda/feed","calendar/feed","events.rss","events/feed","schedule/feed","careers/feed","jobs.rss","jobs/feed","opportunities/feed","vacancies/feed","content/feed","documents/feed","pages/feed","resources/feed","emails/feed","mailinglist/feed","newsletter/feed","subscription/feed","atomfeed","jsonfeed","newsfeed","rssfeed","api/atom","api/feed","api/mobile/feed","api/rss","api/rss.xml","api/v1/feed","api/v2/feed","v1/feed","v2/feed",".opml",".rdf","opml","opml/","rdf","rdf/","category/*/feed","tag/*/feed","tags/feed","topics/feed","author/*/feed","profile/*/feed","user/*/feed","archive/feed","daily/feed","monthly/feed","weekly/feed","yearly/feed","announcements/feed","changelog/feed","press/feed","releases/feed","revisions/feed","updates/feed","app/feed","mobile/feed","international/feed","local/feed","national/feed","regional/feed","education/feed","entertainment/feed","finance/feed","health/feed","industry/feed","market/feed","science/feed","sector/feed","sports/feed","technology/feed","aggregate/feed","all/feed","combined/feed","compilation/feed","everything/feed","actualites/feed","nachrichten/feed","nieuws/feed","noticias/feed","novosti/feed","?atom=1","?download=atom","?download=rss","?export=atom","?export=rss","?feed=atom","?feed=rss","?format=atom","?format=feed","?format=rss","?output=atom","?output=rss","?rss=1","?syndicate=atom","?syndicate=rss","?type=atom","?type=rss","?view=feed","?view=rss","export/rss.xml","extern.php?action=feed&type=atom","external?type=rss2","feed.aspx","feed.cml","feed/atom","feed/atom.rss","feed/atom.xml","feed/rdf","feed/rss.xml","feed/rss2","index.php?action=.xml;type=rss","posts.rss","public/feed.xml","rss.aspx","rss.cfm","rss.php","sitenews","spip.php?page=backend","spip.php?page=backend-breve","spip.php?page=backend-sites","syndicate/rss.xml","syndication.php","xml","feed.jsp","feed.php","feed.pl","feed.py","feed.rb","feeds.json","feeds.php","feeds.xml","_site/feed.xml","build/feed.xml","dist/feed.xml","out/feed.xml","api/feed.xml","cms/feed","contentful/feed","sanity/feed","strapi/feed","docs/feed","documentation/feed","help/feed","kb/feed","support/feed","wiki/feed","branches/feed","commits/feed","issues/feed","pull-requests/feed","releases/feed","tags/feed","analytics/feed","metrics/feed","reports/feed","stats/feed","de/feed","en/feed","es/feed","fr/feed","it/feed","ja/feed","ko/feed","pt/feed","ru/feed","zh/feed","feed.csv","feed.txt","feed.yaml","feed.yml","drupal/feed","joomla/feed","magento/feed","opencart/feed","prestashop/feed","shopify/feed","typo3/feed","woocommerce/feed","discourse/feed","invision/feed","phpbb/feed","vbulletin/feed","xenforo/feed"];function u(e,f){const t=new URL(e).origin;let s=e;const d=[];let r="";for(f&&(r=new URL(e).search);s.length>=t.length;){const a=s.endsWith("/")?s.slice(0,-1):s;c.forEach(o=>{const n=r?`${a}/${o}${r}`:`${a}/${o}`;d.push(n)}),s=s.slice(0,s.lastIndexOf("/"))}return d}function h(e,f,t,s,d){return e.type==="rss"?s=!0:e.type==="atom"&&(d=!0),t.push({url:f,feedType:e.type,title:e.title}),{rssFound:s,atomFound:d}}function g(e,f,t,s,d){return e<f&&!(!d&&t&&s)}async function x(e){e.emit("start",{module:"blindsearch",niceName:"Blind search"});const f=u(e.site,e.options?.keepQueryParams||!1);e.emit("log",{module:"blindsearch",totalCount:f.length});const t=e.options?.all||!1,s=e.options?.maxFeeds||0,d=await y(f,t,s,e);return e.emit("end",{module:"blindsearch",feeds:d.feeds}),d.feeds}async function y(e,f,t,s){const d=[],r=new Set;let a=!1,o=!1,n=0;for(;g(n,e.length,a,o,f);){if(t>0&&d.length>=t){await l(s,d,t);break}const p=e[n],i=await w(p,s,r,d,a,o);if(i.found&&(a=i.rssFound,o=i.atomFound,t>0&&d.length>=t)){await l(s,d,t);break}s.emit("log",{module:"blindsearch",url:!0}),n++}return{feeds:d,rssFound:a,atomFound:o}}async function w(e,f,t,s,d,r,a){try{const o=await m.checkFeed(e);if(o&&!t.has(e)){t.add(e);const n=h(o,e,s,d,r);return d=n.rssFound,r=n.atomFound,f.emit("log",{module:"blindsearch",foundFeedsCount:s.length}),{found:!0,rssFound:d,atomFound:r}}}catch(o){await b(f,e,o)}return{found:!1,rssFound:d,atomFound:r}}async function l(e,f,t){e.emit("log",{module:"blindsearch",message:`Stopped due to reaching maximum feeds limit: ${f.length} feeds found (max ${t} allowed).`})}async function b(e,f,t){e.options?.showErrors&&e.emit("error",{module:"blindsearch",error:`Error fetching ${f}: ${t.message}`,explanation:"An error occurred while trying to fetch a potential feed URL during blind search. This could be due to network timeouts, server errors, 404 not found, or invalid content.",suggestion:"This is normal during blind search as many URLs are tested. The search will continue with other potential feed endpoints."})}module.exports=x;
