#!/usr/bin/env node
"use strict";const te=require("node:events"),ie=require("node:child_process"),ne=require("node:path"),se=require("node:fs"),re=require("node:process"),oe=require("linkedom"),V=require("./deepSearch-D5kT0ejq.cjs"),k=require("node:util");function ae(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var S={},P={},N={},U;function I(){if(U)return N;U=1;class m extends Error{constructor(p,t,n){super(n),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=t,this.exitCode=p,this.nestedError=void 0}}class u extends m{constructor(p){super(1,"commander.invalidArgument",p),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}}return N.CommanderError=m,N.InvalidArgumentError=u,N}var B;function j(){if(B)return P;B=1;const{InvalidArgumentError:m}=I();class u{constructor(t,n){switch(this.description=n||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,t[0]){case"<":this.required=!0,this._name=t.slice(1,-1);break;case"[":this.required=!1,this._name=t.slice(1,-1);break;default:this.required=!0,this._name=t;break}this._name.endsWith("...")&&(this.variadic=!0,this._name=this._name.slice(0,-3))}name(){return this._name}_collectValue(t,n){return n===this.defaultValue||!Array.isArray(n)?[t]:(n.push(t),n)}default(t,n){return this.defaultValue=t,this.defaultValueDescription=n,this}argParser(t){return this.parseArg=t,this}choices(t){return this.argChoices=t.slice(),this.parseArg=(n,s)=>{if(!this.argChoices.includes(n))throw new m(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._collectValue(n,s):n},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}}function h(p){const t=p.name()+(p.variadic===!0?"...":"");return p.required?"<"+t+">":"["+t+"]"}return P.Argument=u,P.humanReadableArgName=h,P}var D={},W={},z;function X(){if(z)return W;z=1;const{humanReadableArgName:m}=j();class u{constructor(){this.helpWidth=void 0,this.minWidthToWrap=40,this.sortSubcommands=!1,this.sortOptions=!1,this.showGlobalOptions=!1}prepareContext(t){this.helpWidth=this.helpWidth??t.helpWidth??80}visibleCommands(t){const n=t.commands.filter(l=>!l._hidden),s=t._getHelpCommand();return s&&!s._hidden&&n.push(s),this.sortSubcommands&&n.sort((l,d)=>l.name().localeCompare(d.name())),n}compareOptions(t,n){const s=l=>l.short?l.short.replace(/^-/,""):l.long.replace(/^--/,"");return s(t).localeCompare(s(n))}visibleOptions(t){const n=t.options.filter(l=>!l.hidden),s=t._getHelpOption();if(s&&!s.hidden){const l=s.short&&t._findOption(s.short),d=s.long&&t._findOption(s.long);!l&&!d?n.push(s):s.long&&!d?n.push(t.createOption(s.long,s.description)):s.short&&!l&&n.push(t.createOption(s.short,s.description))}return this.sortOptions&&n.sort(this.compareOptions),n}visibleGlobalOptions(t){if(!this.showGlobalOptions)return[];const n=[];for(let s=t.parent;s;s=s.parent){const l=s.options.filter(d=>!d.hidden);n.push(...l)}return this.sortOptions&&n.sort(this.compareOptions),n}visibleArguments(t){return t._argsDescription&&t.registeredArguments.forEach(n=>{n.description=n.description||t._argsDescription[n.name()]||""}),t.registeredArguments.find(n=>n.description)?t.registeredArguments:[]}subcommandTerm(t){const n=t.registeredArguments.map(s=>m(s)).join(" ");return t._name+(t._aliases[0]?"|"+t._aliases[0]:"")+(t.options.length?" [options]":"")+(n?" "+n:"")}optionTerm(t){return t.flags}argumentTerm(t){return t.name()}longestSubcommandTermLength(t,n){return n.visibleCommands(t).reduce((s,l)=>Math.max(s,this.displayWidth(n.styleSubcommandTerm(n.subcommandTerm(l)))),0)}longestOptionTermLength(t,n){return n.visibleOptions(t).reduce((s,l)=>Math.max(s,this.displayWidth(n.styleOptionTerm(n.optionTerm(l)))),0)}longestGlobalOptionTermLength(t,n){return n.visibleGlobalOptions(t).reduce((s,l)=>Math.max(s,this.displayWidth(n.styleOptionTerm(n.optionTerm(l)))),0)}longestArgumentTermLength(t,n){return n.visibleArguments(t).reduce((s,l)=>Math.max(s,this.displayWidth(n.styleArgumentTerm(n.argumentTerm(l)))),0)}commandUsage(t){let n=t._name;t._aliases[0]&&(n=n+"|"+t._aliases[0]);let s="";for(let l=t.parent;l;l=l.parent)s=l.name()+" "+s;return s+n+" "+t.usage()}commandDescription(t){return t.description()}subcommandDescription(t){return t.summary()||t.description()}optionDescription(t){const n=[];if(t.argChoices&&n.push(`choices: ${t.argChoices.map(s=>JSON.stringify(s)).join(", ")}`),t.defaultValue!==void 0&&(t.required||t.optional||t.isBoolean()&&typeof t.defaultValue=="boolean")&&n.push(`default: ${t.defaultValueDescription||JSON.stringify(t.defaultValue)}`),t.presetArg!==void 0&&t.optional&&n.push(`preset: ${JSON.stringify(t.presetArg)}`),t.envVar!==void 0&&n.push(`env: ${t.envVar}`),n.length>0){const s=`(${n.join(", ")})`;return t.description?`${t.description} ${s}`:s}return t.description}argumentDescription(t){const n=[];if(t.argChoices&&n.push(`choices: ${t.argChoices.map(s=>JSON.stringify(s)).join(", ")}`),t.defaultValue!==void 0&&n.push(`default: ${t.defaultValueDescription||JSON.stringify(t.defaultValue)}`),n.length>0){const s=`(${n.join(", ")})`;return t.description?`${t.description} ${s}`:s}return t.description}formatItemList(t,n,s){return n.length===0?[]:[s.styleTitle(t),...n,""]}groupItems(t,n,s){const l=new Map;return t.forEach(d=>{const g=s(d);l.has(g)||l.set(g,[])}),n.forEach(d=>{const g=s(d);l.has(g)||l.set(g,[]),l.get(g).push(d)}),l}formatHelp(t,n){const s=n.padWidth(t,n),l=n.helpWidth??80;function d(w,x){return n.formatItem(w,s,x,n)}let g=[`${n.styleTitle("Usage:")} ${n.styleUsage(n.commandUsage(t))}`,""];const C=n.commandDescription(t);C.length>0&&(g=g.concat([n.boxWrap(n.styleCommandDescription(C),l),""]));const y=n.visibleArguments(t).map(w=>d(n.styleArgumentTerm(n.argumentTerm(w)),n.styleArgumentDescription(n.argumentDescription(w))));if(g=g.concat(this.formatItemList("Arguments:",y,n)),this.groupItems(t.options,n.visibleOptions(t),w=>w.helpGroupHeading??"Options:").forEach((w,x)=>{const F=w.map(e=>d(n.styleOptionTerm(n.optionTerm(e)),n.styleOptionDescription(n.optionDescription(e))));g=g.concat(this.formatItemList(x,F,n))}),n.showGlobalOptions){const w=n.visibleGlobalOptions(t).map(x=>d(n.styleOptionTerm(n.optionTerm(x)),n.styleOptionDescription(n.optionDescription(x))));g=g.concat(this.formatItemList("Global Options:",w,n))}return this.groupItems(t.commands,n.visibleCommands(t),w=>w.helpGroup()||"Commands:").forEach((w,x)=>{const F=w.map(e=>d(n.styleSubcommandTerm(n.subcommandTerm(e)),n.styleSubcommandDescription(n.subcommandDescription(e))));g=g.concat(this.formatItemList(x,F,n))}),g.join(`
`)}displayWidth(t){return h(t).length}styleTitle(t){return t}styleUsage(t){return t.split(" ").map(n=>n==="[options]"?this.styleOptionText(n):n==="[command]"?this.styleSubcommandText(n):n[0]==="["||n[0]==="<"?this.styleArgumentText(n):this.styleCommandText(n)).join(" ")}styleCommandDescription(t){return this.styleDescriptionText(t)}styleOptionDescription(t){return this.styleDescriptionText(t)}styleSubcommandDescription(t){return this.styleDescriptionText(t)}styleArgumentDescription(t){return this.styleDescriptionText(t)}styleDescriptionText(t){return t}styleOptionTerm(t){return this.styleOptionText(t)}styleSubcommandTerm(t){return t.split(" ").map(n=>n==="[options]"?this.styleOptionText(n):n[0]==="["||n[0]==="<"?this.styleArgumentText(n):this.styleSubcommandText(n)).join(" ")}styleArgumentTerm(t){return this.styleArgumentText(t)}styleOptionText(t){return t}styleArgumentText(t){return t}styleSubcommandText(t){return t}styleCommandText(t){return t}padWidth(t,n){return Math.max(n.longestOptionTermLength(t,n),n.longestGlobalOptionTermLength(t,n),n.longestSubcommandTermLength(t,n),n.longestArgumentTermLength(t,n))}preformatted(t){return/\n[^\S\r\n]/.test(t)}formatItem(t,n,s,l){const g=" ".repeat(2);if(!s)return g+t;const C=t.padEnd(n+t.length-l.displayWidth(t)),y=2,v=(this.helpWidth??80)-n-y-2;let w;return v<this.minWidthToWrap||l.preformatted(s)?w=s:w=l.boxWrap(s,v).replace(/\n/g,`
`+" ".repeat(n+y)),g+C+" ".repeat(y)+w.replace(/\n/g,`
${g}`)}boxWrap(t,n){if(n<this.minWidthToWrap)return t;const s=t.split(/\r\n|\n/),l=/[\s]*[^\s]+/g,d=[];return s.forEach(g=>{const C=g.match(l);if(C===null){d.push("");return}let y=[C.shift()],$=this.displayWidth(y[0]);C.forEach(v=>{const w=this.displayWidth(v);if($+w<=n){y.push(v),$+=w;return}d.push(y.join(""));const x=v.trimStart();y=[x],$=this.displayWidth(x)}),d.push(y.join(""))}),d.join(`
`)}}function h(p){const t=/\x1b\[\d*(;\d*)*m/g;return p.replace(t,"")}return W.Help=u,W.stripColor=h,W}var q={},J;function Z(){if(J)return q;J=1;const{InvalidArgumentError:m}=I();class u{constructor(s,l){this.flags=s,this.description=l||"",this.required=s.includes("<"),this.optional=s.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(s),this.mandatory=!1;const d=t(s);this.short=d.shortFlag,this.long=d.longFlag,this.negate=!1,this.long&&(this.negate=this.long.startsWith("--no-")),this.defaultValue=void 0,this.defaultValueDescription=void 0,this.presetArg=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0,this.conflictsWith=[],this.implied=void 0,this.helpGroupHeading=void 0}default(s,l){return this.defaultValue=s,this.defaultValueDescription=l,this}preset(s){return this.presetArg=s,this}conflicts(s){return this.conflictsWith=this.conflictsWith.concat(s),this}implies(s){let l=s;return typeof s=="string"&&(l={[s]:!0}),this.implied=Object.assign(this.implied||{},l),this}env(s){return this.envVar=s,this}argParser(s){return this.parseArg=s,this}makeOptionMandatory(s=!0){return this.mandatory=!!s,this}hideHelp(s=!0){return this.hidden=!!s,this}_collectValue(s,l){return l===this.defaultValue||!Array.isArray(l)?[s]:(l.push(s),l)}choices(s){return this.argChoices=s.slice(),this.parseArg=(l,d)=>{if(!this.argChoices.includes(l))throw new m(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._collectValue(l,d):l},this}name(){return this.long?this.long.replace(/^--/,""):this.short.replace(/^-/,"")}attributeName(){return this.negate?p(this.name().replace(/^no-/,"")):p(this.name())}helpGroup(s){return this.helpGroupHeading=s,this}is(s){return this.short===s||this.long===s}isBoolean(){return!this.required&&!this.optional&&!this.negate}}class h{constructor(s){this.positiveOptions=new Map,this.negativeOptions=new Map,this.dualOptions=new Set,s.forEach(l=>{l.negate?this.negativeOptions.set(l.attributeName(),l):this.positiveOptions.set(l.attributeName(),l)}),this.negativeOptions.forEach((l,d)=>{this.positiveOptions.has(d)&&this.dualOptions.add(d)})}valueFromOption(s,l){const d=l.attributeName();if(!this.dualOptions.has(d))return!0;const g=this.negativeOptions.get(d).presetArg,C=g!==void 0?g:!1;return l.negate===(C===s)}}function p(n){return n.split("-").reduce((s,l)=>s+l[0].toUpperCase()+l.slice(1))}function t(n){let s,l;const d=/^-[^-]$/,g=/^--[^-]/,C=n.split(/[ |,]+/).concat("guard");if(d.test(C[0])&&(s=C.shift()),g.test(C[0])&&(l=C.shift()),!s&&d.test(C[0])&&(s=C.shift()),!s&&g.test(C[0])&&(s=l,l=C.shift()),C[0].startsWith("-")){const y=C[0],$=`option creation failed due to '${y}' in option flags '${n}'`;throw/^-[^-][^-]/.test(y)?new Error(`${$}
- a short flag is a single dash and a single character
  - either use a single dash and a single character (for a short flag)
  - or use a double dash for a long option (and can have two, like '--ws, --workspace')`):d.test(y)?new Error(`${$}
- too many short flags`):g.test(y)?new Error(`${$}
- too many long flags`):new Error(`${$}
- unrecognised flag format`)}if(s===void 0&&l===void 0)throw new Error(`option creation failed due to no flags found in '${n}'.`);return{shortFlag:s,longFlag:l}}return q.Option=u,q.DualOptions=h,q}var M={},K;function le(){if(K)return M;K=1;const m=3;function u(p,t){if(Math.abs(p.length-t.length)>m)return Math.max(p.length,t.length);const n=[];for(let s=0;s<=p.length;s++)n[s]=[s];for(let s=0;s<=t.length;s++)n[0][s]=s;for(let s=1;s<=t.length;s++)for(let l=1;l<=p.length;l++){let d=1;p[l-1]===t[s-1]?d=0:d=1,n[l][s]=Math.min(n[l-1][s]+1,n[l][s-1]+1,n[l-1][s-1]+d),l>1&&s>1&&p[l-1]===t[s-2]&&p[l-2]===t[s-1]&&(n[l][s]=Math.min(n[l][s],n[l-2][s-2]+1))}return n[p.length][t.length]}function h(p,t){if(!t||t.length===0)return"";t=Array.from(new Set(t));const n=p.startsWith("--");n&&(p=p.slice(2),t=t.map(g=>g.slice(2)));let s=[],l=m;const d=.4;return t.forEach(g=>{if(g.length<=1)return;const C=u(p,g),y=Math.max(p.length,g.length);(y-C)/y>d&&(C<l?(l=C,s=[g]):C===l&&s.push(g))}),s.sort((g,C)=>g.localeCompare(C)),n&&(s=s.map(g=>`--${g}`)),s.length>1?`
(Did you mean one of ${s.join(", ")}?)`:s.length===1?`
(Did you mean ${s[0]}?)`:""}return M.suggestSimilar=h,M}var Y;function ue(){if(Y)return D;Y=1;const m=te.EventEmitter,u=ie,h=ne,p=se,t=re,{Argument:n,humanReadableArgName:s}=j(),{CommanderError:l}=I(),{Help:d,stripColor:g}=X(),{Option:C,DualOptions:y}=Z(),{suggestSimilar:$}=le();class v extends m{constructor(e){super(),this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!1,this.registeredArguments=[],this._args=this.registeredArguments,this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=e||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._executableDir=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._summary="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!0,this._savedState=null,this._outputConfiguration={writeOut:i=>t.stdout.write(i),writeErr:i=>t.stderr.write(i),outputError:(i,r)=>r(i),getOutHelpWidth:()=>t.stdout.isTTY?t.stdout.columns:void 0,getErrHelpWidth:()=>t.stderr.isTTY?t.stderr.columns:void 0,getOutHasColors:()=>x()??(t.stdout.isTTY&&t.stdout.hasColors?.()),getErrHasColors:()=>x()??(t.stderr.isTTY&&t.stderr.hasColors?.()),stripColor:i=>g(i)},this._hidden=!1,this._helpOption=void 0,this._addImplicitHelpCommand=void 0,this._helpCommand=void 0,this._helpConfiguration={},this._helpGroupHeading=void 0,this._defaultCommandGroup=void 0,this._defaultOptionGroup=void 0}copyInheritedSettings(e){return this._outputConfiguration=e._outputConfiguration,this._helpOption=e._helpOption,this._helpCommand=e._helpCommand,this._helpConfiguration=e._helpConfiguration,this._exitCallback=e._exitCallback,this._storeOptionsAsProperties=e._storeOptionsAsProperties,this._combineFlagAndOptionalValue=e._combineFlagAndOptionalValue,this._allowExcessArguments=e._allowExcessArguments,this._enablePositionalOptions=e._enablePositionalOptions,this._showHelpAfterError=e._showHelpAfterError,this._showSuggestionAfterError=e._showSuggestionAfterError,this}_getCommandAndAncestors(){const e=[];for(let i=this;i;i=i.parent)e.push(i);return e}command(e,i,r){let o=i,a=r;typeof o=="object"&&o!==null&&(a=o,o=null),a=a||{};const[,c,_]=e.match(/([^ ]+) *(.*)/),b=this.createCommand(c);return o&&(b.description(o),b._executableHandler=!0),a.isDefault&&(this._defaultCommandName=b._name),b._hidden=!!(a.noHelp||a.hidden),b._executableFile=a.executableFile||null,_&&b.arguments(_),this._registerCommand(b),b.parent=this,b.copyInheritedSettings(this),o?this:b}createCommand(e){return new v(e)}createHelp(){return Object.assign(new d,this.configureHelp())}configureHelp(e){return e===void 0?this._helpConfiguration:(this._helpConfiguration=e,this)}configureOutput(e){return e===void 0?this._outputConfiguration:(this._outputConfiguration={...this._outputConfiguration,...e},this)}showHelpAfterError(e=!0){return typeof e!="string"&&(e=!!e),this._showHelpAfterError=e,this}showSuggestionAfterError(e=!0){return this._showSuggestionAfterError=!!e,this}addCommand(e,i){if(!e._name)throw new Error(`Command passed to .addCommand() must have a name
- specify the name in Command constructor or using .name()`);return i=i||{},i.isDefault&&(this._defaultCommandName=e._name),(i.noHelp||i.hidden)&&(e._hidden=!0),this._registerCommand(e),e.parent=this,e._checkForBrokenPassThrough(),this}createArgument(e,i){return new n(e,i)}argument(e,i,r,o){const a=this.createArgument(e,i);return typeof r=="function"?a.default(o).argParser(r):a.default(r),this.addArgument(a),this}arguments(e){return e.trim().split(/ +/).forEach(i=>{this.argument(i)}),this}addArgument(e){const i=this.registeredArguments.slice(-1)[0];if(i?.variadic)throw new Error(`only the last argument can be variadic '${i.name()}'`);if(e.required&&e.defaultValue!==void 0&&e.parseArg===void 0)throw new Error(`a default value for a required argument is never used: '${e.name()}'`);return this.registeredArguments.push(e),this}helpCommand(e,i){if(typeof e=="boolean")return this._addImplicitHelpCommand=e,e&&this._defaultCommandGroup&&this._initCommandGroup(this._getHelpCommand()),this;const r=e??"help [command]",[,o,a]=r.match(/([^ ]+) *(.*)/),c=i??"display help for command",_=this.createCommand(o);return _.helpOption(!1),a&&_.arguments(a),c&&_.description(c),this._addImplicitHelpCommand=!0,this._helpCommand=_,(e||i)&&this._initCommandGroup(_),this}addHelpCommand(e,i){return typeof e!="object"?(this.helpCommand(e,i),this):(this._addImplicitHelpCommand=!0,this._helpCommand=e,this._initCommandGroup(e),this)}_getHelpCommand(){return this._addImplicitHelpCommand??(this.commands.length&&!this._actionHandler&&!this._findCommand("help"))?(this._helpCommand===void 0&&this.helpCommand(void 0,void 0),this._helpCommand):null}hook(e,i){const r=["preSubcommand","preAction","postAction"];if(!r.includes(e))throw new Error(`Unexpected value for event passed to hook : '${e}'.
Expecting one of '${r.join("', '")}'`);return this._lifeCycleHooks[e]?this._lifeCycleHooks[e].push(i):this._lifeCycleHooks[e]=[i],this}exitOverride(e){return e?this._exitCallback=e:this._exitCallback=i=>{if(i.code!=="commander.executeSubCommandAsync")throw i},this}_exit(e,i,r){this._exitCallback&&this._exitCallback(new l(e,i,r)),t.exit(e)}action(e){const i=r=>{const o=this.registeredArguments.length,a=r.slice(0,o);return this._storeOptionsAsProperties?a[o]=this:a[o]=this.opts(),a.push(this),e.apply(this,a)};return this._actionHandler=i,this}createOption(e,i){return new C(e,i)}_callParseArg(e,i,r,o){try{return e.parseArg(i,r)}catch(a){if(a.code==="commander.invalidArgument"){const c=`${o} ${a.message}`;this.error(c,{exitCode:a.exitCode,code:a.code})}throw a}}_registerOption(e){const i=e.short&&this._findOption(e.short)||e.long&&this._findOption(e.long);if(i){const r=e.long&&this._findOption(e.long)?e.long:e.short;throw new Error(`Cannot add option '${e.flags}'${this._name&&` to command '${this._name}'`} due to conflicting flag '${r}'
-  already used by option '${i.flags}'`)}this._initOptionGroup(e),this.options.push(e)}_registerCommand(e){const i=o=>[o.name()].concat(o.aliases()),r=i(e).find(o=>this._findCommand(o));if(r){const o=i(this._findCommand(r)).join("|"),a=i(e).join("|");throw new Error(`cannot add command '${a}' as already have command '${o}'`)}this._initCommandGroup(e),this.commands.push(e)}addOption(e){this._registerOption(e);const i=e.name(),r=e.attributeName();if(e.negate){const a=e.long.replace(/^--no-/,"--");this._findOption(a)||this.setOptionValueWithSource(r,e.defaultValue===void 0?!0:e.defaultValue,"default")}else e.defaultValue!==void 0&&this.setOptionValueWithSource(r,e.defaultValue,"default");const o=(a,c,_)=>{a==null&&e.presetArg!==void 0&&(a=e.presetArg);const b=this.getOptionValue(r);a!==null&&e.parseArg?a=this._callParseArg(e,a,b,c):a!==null&&e.variadic&&(a=e._collectValue(a,b)),a==null&&(e.negate?a=!1:e.isBoolean()||e.optional?a=!0:a=""),this.setOptionValueWithSource(r,a,_)};return this.on("option:"+i,a=>{const c=`error: option '${e.flags}' argument '${a}' is invalid.`;o(a,c,"cli")}),e.envVar&&this.on("optionEnv:"+i,a=>{const c=`error: option '${e.flags}' value '${a}' from env '${e.envVar}' is invalid.`;o(a,c,"env")}),this}_optionEx(e,i,r,o,a){if(typeof i=="object"&&i instanceof C)throw new Error("To add an Option object use addOption() instead of option() or requiredOption()");const c=this.createOption(i,r);if(c.makeOptionMandatory(!!e.mandatory),typeof o=="function")c.default(a).argParser(o);else if(o instanceof RegExp){const _=o;o=(b,A)=>{const f=_.exec(b);return f?f[0]:A},c.default(a).argParser(o)}else c.default(o);return this.addOption(c)}option(e,i,r,o){return this._optionEx({},e,i,r,o)}requiredOption(e,i,r,o){return this._optionEx({mandatory:!0},e,i,r,o)}combineFlagAndOptionalValue(e=!0){return this._combineFlagAndOptionalValue=!!e,this}allowUnknownOption(e=!0){return this._allowUnknownOption=!!e,this}allowExcessArguments(e=!0){return this._allowExcessArguments=!!e,this}enablePositionalOptions(e=!0){return this._enablePositionalOptions=!!e,this}passThroughOptions(e=!0){return this._passThroughOptions=!!e,this._checkForBrokenPassThrough(),this}_checkForBrokenPassThrough(){if(this.parent&&this._passThroughOptions&&!this.parent._enablePositionalOptions)throw new Error(`passThroughOptions cannot be used for '${this._name}' without turning on enablePositionalOptions for parent command(s)`)}storeOptionsAsProperties(e=!0){if(this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");if(Object.keys(this._optionValues).length)throw new Error("call .storeOptionsAsProperties() before setting option values");return this._storeOptionsAsProperties=!!e,this}getOptionValue(e){return this._storeOptionsAsProperties?this[e]:this._optionValues[e]}setOptionValue(e,i){return this.setOptionValueWithSource(e,i,void 0)}setOptionValueWithSource(e,i,r){return this._storeOptionsAsProperties?this[e]=i:this._optionValues[e]=i,this._optionValueSources[e]=r,this}getOptionValueSource(e){return this._optionValueSources[e]}getOptionValueSourceWithGlobals(e){let i;return this._getCommandAndAncestors().forEach(r=>{r.getOptionValueSource(e)!==void 0&&(i=r.getOptionValueSource(e))}),i}_prepareUserArgs(e,i){if(e!==void 0&&!Array.isArray(e))throw new Error("first parameter to parse must be array or undefined");if(i=i||{},e===void 0&&i.from===void 0){t.versions?.electron&&(i.from="electron");const o=t.execArgv??[];(o.includes("-e")||o.includes("--eval")||o.includes("-p")||o.includes("--print"))&&(i.from="eval")}e===void 0&&(e=t.argv),this.rawArgs=e.slice();let r;switch(i.from){case void 0:case"node":this._scriptPath=e[1],r=e.slice(2);break;case"electron":t.defaultApp?(this._scriptPath=e[1],r=e.slice(2)):r=e.slice(1);break;case"user":r=e.slice(0);break;case"eval":r=e.slice(1);break;default:throw new Error(`unexpected parse option { from: '${i.from}' }`)}return!this._name&&this._scriptPath&&this.nameFromFilename(this._scriptPath),this._name=this._name||"program",r}parse(e,i){this._prepareForParse();const r=this._prepareUserArgs(e,i);return this._parseCommand([],r),this}async parseAsync(e,i){this._prepareForParse();const r=this._prepareUserArgs(e,i);return await this._parseCommand([],r),this}_prepareForParse(){this._savedState===null?this.saveStateBeforeParse():this.restoreStateBeforeParse()}saveStateBeforeParse(){this._savedState={_name:this._name,_optionValues:{...this._optionValues},_optionValueSources:{...this._optionValueSources}}}restoreStateBeforeParse(){if(this._storeOptionsAsProperties)throw new Error(`Can not call parse again when storeOptionsAsProperties is true.
- either make a new Command for each call to parse, or stop storing options as properties`);this._name=this._savedState._name,this._scriptPath=null,this.rawArgs=[],this._optionValues={...this._savedState._optionValues},this._optionValueSources={...this._savedState._optionValueSources},this.args=[],this.processedArgs=[]}_checkForMissingExecutable(e,i,r){if(p.existsSync(e))return;const o=i?`searched for local subcommand relative to directory '${i}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory",a=`'${e}' does not exist
 - if '${r}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name or path
 - ${o}`;throw new Error(a)}_executeSubCommand(e,i){i=i.slice();let r=!1;const o=[".js",".ts",".tsx",".mjs",".cjs"];function a(f,O){const E=h.resolve(f,O);if(p.existsSync(E))return E;if(o.includes(h.extname(O)))return;const R=o.find(ee=>p.existsSync(`${E}${ee}`));if(R)return`${E}${R}`}this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let c=e._executableFile||`${this._name}-${e._name}`,_=this._executableDir||"";if(this._scriptPath){let f;try{f=p.realpathSync(this._scriptPath)}catch{f=this._scriptPath}_=h.resolve(h.dirname(f),_)}if(_){let f=a(_,c);if(!f&&!e._executableFile&&this._scriptPath){const O=h.basename(this._scriptPath,h.extname(this._scriptPath));O!==this._name&&(f=a(_,`${O}-${e._name}`))}c=f||c}r=o.includes(h.extname(c));let b;t.platform!=="win32"?r?(i.unshift(c),i=w(t.execArgv).concat(i),b=u.spawn(t.argv[0],i,{stdio:"inherit"})):b=u.spawn(c,i,{stdio:"inherit"}):(this._checkForMissingExecutable(c,_,e._name),i.unshift(c),i=w(t.execArgv).concat(i),b=u.spawn(t.execPath,i,{stdio:"inherit"})),b.killed||["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach(O=>{t.on(O,()=>{b.killed===!1&&b.exitCode===null&&b.kill(O)})});const A=this._exitCallback;b.on("close",f=>{f=f??1,A?A(new l(f,"commander.executeSubCommandAsync","(close)")):t.exit(f)}),b.on("error",f=>{if(f.code==="ENOENT")this._checkForMissingExecutable(c,_,e._name);else if(f.code==="EACCES")throw new Error(`'${c}' not executable`);if(!A)t.exit(1);else{const O=new l(1,"commander.executeSubCommandAsync","(error)");O.nestedError=f,A(O)}}),this.runningCommand=b}_dispatchSubcommand(e,i,r){const o=this._findCommand(e);o||this.help({error:!0}),o._prepareForParse();let a;return a=this._chainOrCallSubCommandHook(a,o,"preSubcommand"),a=this._chainOrCall(a,()=>{if(o._executableHandler)this._executeSubCommand(o,i.concat(r));else return o._parseCommand(i,r)}),a}_dispatchHelpCommand(e){e||this.help();const i=this._findCommand(e);return i&&!i._executableHandler&&i.help(),this._dispatchSubcommand(e,[],[this._getHelpOption()?.long??this._getHelpOption()?.short??"--help"])}_checkNumberOfArguments(){this.registeredArguments.forEach((e,i)=>{e.required&&this.args[i]==null&&this.missingArgument(e.name())}),!(this.registeredArguments.length>0&&this.registeredArguments[this.registeredArguments.length-1].variadic)&&this.args.length>this.registeredArguments.length&&this._excessArguments(this.args)}_processArguments(){const e=(r,o,a)=>{let c=o;if(o!==null&&r.parseArg){const _=`error: command-argument value '${o}' is invalid for argument '${r.name()}'.`;c=this._callParseArg(r,o,a,_)}return c};this._checkNumberOfArguments();const i=[];this.registeredArguments.forEach((r,o)=>{let a=r.defaultValue;r.variadic?o<this.args.length?(a=this.args.slice(o),r.parseArg&&(a=a.reduce((c,_)=>e(r,_,c),r.defaultValue))):a===void 0&&(a=[]):o<this.args.length&&(a=this.args[o],r.parseArg&&(a=e(r,a,r.defaultValue))),i[o]=a}),this.processedArgs=i}_chainOrCall(e,i){return e?.then&&typeof e.then=="function"?e.then(()=>i()):i()}_chainOrCallHooks(e,i){let r=e;const o=[];return this._getCommandAndAncestors().reverse().filter(a=>a._lifeCycleHooks[i]!==void 0).forEach(a=>{a._lifeCycleHooks[i].forEach(c=>{o.push({hookedCommand:a,callback:c})})}),i==="postAction"&&o.reverse(),o.forEach(a=>{r=this._chainOrCall(r,()=>a.callback(a.hookedCommand,this))}),r}_chainOrCallSubCommandHook(e,i,r){let o=e;return this._lifeCycleHooks[r]!==void 0&&this._lifeCycleHooks[r].forEach(a=>{o=this._chainOrCall(o,()=>a(this,i))}),o}_parseCommand(e,i){const r=this.parseOptions(i);if(this._parseOptionsEnv(),this._parseOptionsImplied(),e=e.concat(r.operands),i=r.unknown,this.args=e.concat(i),e&&this._findCommand(e[0]))return this._dispatchSubcommand(e[0],e.slice(1),i);if(this._getHelpCommand()&&e[0]===this._getHelpCommand().name())return this._dispatchHelpCommand(e[1]);if(this._defaultCommandName)return this._outputHelpIfRequested(i),this._dispatchSubcommand(this._defaultCommandName,e,i);this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName&&this.help({error:!0}),this._outputHelpIfRequested(r.unknown),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();const o=()=>{r.unknown.length>0&&this.unknownOption(r.unknown[0])},a=`command:${this.name()}`;if(this._actionHandler){o(),this._processArguments();let c;return c=this._chainOrCallHooks(c,"preAction"),c=this._chainOrCall(c,()=>this._actionHandler(this.processedArgs)),this.parent&&(c=this._chainOrCall(c,()=>{this.parent.emit(a,e,i)})),c=this._chainOrCallHooks(c,"postAction"),c}if(this.parent?.listenerCount(a))o(),this._processArguments(),this.parent.emit(a,e,i);else if(e.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",e,i);this.listenerCount("command:*")?this.emit("command:*",e,i):this.commands.length?this.unknownCommand():(o(),this._processArguments())}else this.commands.length?(o(),this.help({error:!0})):(o(),this._processArguments())}_findCommand(e){if(e)return this.commands.find(i=>i._name===e||i._aliases.includes(e))}_findOption(e){return this.options.find(i=>i.is(e))}_checkForMissingMandatoryOptions(){this._getCommandAndAncestors().forEach(e=>{e.options.forEach(i=>{i.mandatory&&e.getOptionValue(i.attributeName())===void 0&&e.missingMandatoryOptionValue(i)})})}_checkForConflictingLocalOptions(){const e=this.options.filter(r=>{const o=r.attributeName();return this.getOptionValue(o)===void 0?!1:this.getOptionValueSource(o)!=="default"});e.filter(r=>r.conflictsWith.length>0).forEach(r=>{const o=e.find(a=>r.conflictsWith.includes(a.attributeName()));o&&this._conflictingOption(r,o)})}_checkForConflictingOptions(){this._getCommandAndAncestors().forEach(e=>{e._checkForConflictingLocalOptions()})}parseOptions(e){const i=[],r=[];let o=i;function a(f){return f.length>1&&f[0]==="-"}const c=f=>/^-\d*\.?\d+(e[+-]?\d+)?$/.test(f)?!this._getCommandAndAncestors().some(O=>O.options.map(E=>E.short).some(E=>/^-\d$/.test(E))):!1;let _=null,b=null,A=0;for(;A<e.length||b;){const f=b??e[A++];if(b=null,f==="--"){o===r&&o.push(f),o.push(...e.slice(A));break}if(_&&(!a(f)||c(f))){this.emit(`option:${_.name()}`,f);continue}if(_=null,a(f)){const O=this._findOption(f);if(O){if(O.required){const E=e[A++];E===void 0&&this.optionMissingArgument(O),this.emit(`option:${O.name()}`,E)}else if(O.optional){let E=null;A<e.length&&(!a(e[A])||c(e[A]))&&(E=e[A++]),this.emit(`option:${O.name()}`,E)}else this.emit(`option:${O.name()}`);_=O.variadic?O:null;continue}}if(f.length>2&&f[0]==="-"&&f[1]!=="-"){const O=this._findOption(`-${f[1]}`);if(O){O.required||O.optional&&this._combineFlagAndOptionalValue?this.emit(`option:${O.name()}`,f.slice(2)):(this.emit(`option:${O.name()}`),b=`-${f.slice(2)}`);continue}}if(/^--[^=]+=/.test(f)){const O=f.indexOf("="),E=this._findOption(f.slice(0,O));if(E&&(E.required||E.optional)){this.emit(`option:${E.name()}`,f.slice(O+1));continue}}if(o===i&&a(f)&&!(this.commands.length===0&&c(f))&&(o=r),(this._enablePositionalOptions||this._passThroughOptions)&&i.length===0&&r.length===0){if(this._findCommand(f)){i.push(f),r.push(...e.slice(A));break}else if(this._getHelpCommand()&&f===this._getHelpCommand().name()){i.push(f,...e.slice(A));break}else if(this._defaultCommandName){r.push(f,...e.slice(A));break}}if(this._passThroughOptions){o.push(f,...e.slice(A));break}o.push(f)}return{operands:i,unknown:r}}opts(){if(this._storeOptionsAsProperties){const e={},i=this.options.length;for(let r=0;r<i;r++){const o=this.options[r].attributeName();e[o]=o===this._versionOptionName?this._version:this[o]}return e}return this._optionValues}optsWithGlobals(){return this._getCommandAndAncestors().reduce((e,i)=>Object.assign(e,i.opts()),{})}error(e,i){this._outputConfiguration.outputError(`${e}
`,this._outputConfiguration.writeErr),typeof this._showHelpAfterError=="string"?this._outputConfiguration.writeErr(`${this._showHelpAfterError}
`):this._showHelpAfterError&&(this._outputConfiguration.writeErr(`
`),this.outputHelp({error:!0}));const r=i||{},o=r.exitCode||1,a=r.code||"commander.error";this._exit(o,a,e)}_parseOptionsEnv(){this.options.forEach(e=>{if(e.envVar&&e.envVar in t.env){const i=e.attributeName();(this.getOptionValue(i)===void 0||["default","config","env"].includes(this.getOptionValueSource(i)))&&(e.required||e.optional?this.emit(`optionEnv:${e.name()}`,t.env[e.envVar]):this.emit(`optionEnv:${e.name()}`))}})}_parseOptionsImplied(){const e=new y(this.options),i=r=>this.getOptionValue(r)!==void 0&&!["default","implied"].includes(this.getOptionValueSource(r));this.options.filter(r=>r.implied!==void 0&&i(r.attributeName())&&e.valueFromOption(this.getOptionValue(r.attributeName()),r)).forEach(r=>{Object.keys(r.implied).filter(o=>!i(o)).forEach(o=>{this.setOptionValueWithSource(o,r.implied[o],"implied")})})}missingArgument(e){const i=`error: missing required argument '${e}'`;this.error(i,{code:"commander.missingArgument"})}optionMissingArgument(e){const i=`error: option '${e.flags}' argument missing`;this.error(i,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue(e){const i=`error: required option '${e.flags}' not specified`;this.error(i,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption(e,i){const r=c=>{const _=c.attributeName(),b=this.getOptionValue(_),A=this.options.find(O=>O.negate&&_===O.attributeName()),f=this.options.find(O=>!O.negate&&_===O.attributeName());return A&&(A.presetArg===void 0&&b===!1||A.presetArg!==void 0&&b===A.presetArg)?A:f||c},o=c=>{const _=r(c),b=_.attributeName();return this.getOptionValueSource(b)==="env"?`environment variable '${_.envVar}'`:`option '${_.flags}'`},a=`error: ${o(e)} cannot be used with ${o(i)}`;this.error(a,{code:"commander.conflictingOption"})}unknownOption(e){if(this._allowUnknownOption)return;let i="";if(e.startsWith("--")&&this._showSuggestionAfterError){let o=[],a=this;do{const c=a.createHelp().visibleOptions(a).filter(_=>_.long).map(_=>_.long);o=o.concat(c),a=a.parent}while(a&&!a._enablePositionalOptions);i=$(e,o)}const r=`error: unknown option '${e}'${i}`;this.error(r,{code:"commander.unknownOption"})}_excessArguments(e){if(this._allowExcessArguments)return;const i=this.registeredArguments.length,r=i===1?"":"s",a=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${i} argument${r} but got ${e.length}.`;this.error(a,{code:"commander.excessArguments"})}unknownCommand(){const e=this.args[0];let i="";if(this._showSuggestionAfterError){const o=[];this.createHelp().visibleCommands(this).forEach(a=>{o.push(a.name()),a.alias()&&o.push(a.alias())}),i=$(e,o)}const r=`error: unknown command '${e}'${i}`;this.error(r,{code:"commander.unknownCommand"})}version(e,i,r){if(e===void 0)return this._version;this._version=e,i=i||"-V, --version",r=r||"output the version number";const o=this.createOption(i,r);return this._versionOptionName=o.attributeName(),this._registerOption(o),this.on("option:"+o.name(),()=>{this._outputConfiguration.writeOut(`${e}
`),this._exit(0,"commander.version",e)}),this}description(e,i){return e===void 0&&i===void 0?this._description:(this._description=e,i&&(this._argsDescription=i),this)}summary(e){return e===void 0?this._summary:(this._summary=e,this)}alias(e){if(e===void 0)return this._aliases[0];let i=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler&&(i=this.commands[this.commands.length-1]),e===i._name)throw new Error("Command alias can't be the same as its name");const r=this.parent?._findCommand(e);if(r){const o=[r.name()].concat(r.aliases()).join("|");throw new Error(`cannot add alias '${e}' to command '${this.name()}' as already have command '${o}'`)}return i._aliases.push(e),this}aliases(e){return e===void 0?this._aliases:(e.forEach(i=>this.alias(i)),this)}usage(e){if(e===void 0){if(this._usage)return this._usage;const i=this.registeredArguments.map(r=>s(r));return[].concat(this.options.length||this._helpOption!==null?"[options]":[],this.commands.length?"[command]":[],this.registeredArguments.length?i:[]).join(" ")}return this._usage=e,this}name(e){return e===void 0?this._name:(this._name=e,this)}helpGroup(e){return e===void 0?this._helpGroupHeading??"":(this._helpGroupHeading=e,this)}commandsGroup(e){return e===void 0?this._defaultCommandGroup??"":(this._defaultCommandGroup=e,this)}optionsGroup(e){return e===void 0?this._defaultOptionGroup??"":(this._defaultOptionGroup=e,this)}_initOptionGroup(e){this._defaultOptionGroup&&!e.helpGroupHeading&&e.helpGroup(this._defaultOptionGroup)}_initCommandGroup(e){this._defaultCommandGroup&&!e.helpGroup()&&e.helpGroup(this._defaultCommandGroup)}nameFromFilename(e){return this._name=h.basename(e,h.extname(e)),this}executableDir(e){return e===void 0?this._executableDir:(this._executableDir=e,this)}helpInformation(e){const i=this.createHelp(),r=this._getOutputContext(e);i.prepareContext({error:r.error,helpWidth:r.helpWidth,outputHasColors:r.hasColors});const o=i.formatHelp(this,i);return r.hasColors?o:this._outputConfiguration.stripColor(o)}_getOutputContext(e){e=e||{};const i=!!e.error;let r,o,a;return i?(r=_=>this._outputConfiguration.writeErr(_),o=this._outputConfiguration.getErrHasColors(),a=this._outputConfiguration.getErrHelpWidth()):(r=_=>this._outputConfiguration.writeOut(_),o=this._outputConfiguration.getOutHasColors(),a=this._outputConfiguration.getOutHelpWidth()),{error:i,write:_=>(o||(_=this._outputConfiguration.stripColor(_)),r(_)),hasColors:o,helpWidth:a}}outputHelp(e){let i;typeof e=="function"&&(i=e,e=void 0);const r=this._getOutputContext(e),o={error:r.error,write:r.write,command:this};this._getCommandAndAncestors().reverse().forEach(c=>c.emit("beforeAllHelp",o)),this.emit("beforeHelp",o);let a=this.helpInformation({error:r.error});if(i&&(a=i(a),typeof a!="string"&&!Buffer.isBuffer(a)))throw new Error("outputHelp callback must return a string or a Buffer");r.write(a),this._getHelpOption()?.long&&this.emit(this._getHelpOption().long),this.emit("afterHelp",o),this._getCommandAndAncestors().forEach(c=>c.emit("afterAllHelp",o))}helpOption(e,i){return typeof e=="boolean"?(e?(this._helpOption===null&&(this._helpOption=void 0),this._defaultOptionGroup&&this._initOptionGroup(this._getHelpOption())):this._helpOption=null,this):(this._helpOption=this.createOption(e??"-h, --help",i??"display help for command"),(e||i)&&this._initOptionGroup(this._helpOption),this)}_getHelpOption(){return this._helpOption===void 0&&this.helpOption(void 0,void 0),this._helpOption}addHelpOption(e){return this._helpOption=e,this._initOptionGroup(e),this}help(e){this.outputHelp(e);let i=Number(t.exitCode??0);i===0&&e&&typeof e!="function"&&e.error&&(i=1),this._exit(i,"commander.help","(outputHelp)")}addHelpText(e,i){const r=["beforeAll","before","after","afterAll"];if(!r.includes(e))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${r.join("', '")}'`);const o=`${e}Help`;return this.on(o,a=>{let c;typeof i=="function"?c=i({error:a.error,command:a.command}):c=i,c&&a.write(`${c}
`)}),this}_outputHelpIfRequested(e){const i=this._getHelpOption();i&&e.find(o=>i.is(o))&&(this.outputHelp(),this._exit(0,"commander.helpDisplayed","(outputHelp)"))}}function w(F){return F.map(e=>{if(!e.startsWith("--inspect"))return e;let i,r="127.0.0.1",o="9229",a;return(a=e.match(/^(--inspect(-brk)?)$/))!==null?i=a[1]:(a=e.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null?(i=a[1],/^\d+$/.test(a[3])?o=a[3]:r=a[3]):(a=e.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null&&(i=a[1],r=a[3],o=a[4]),i&&o!=="0"?`${i}=${r}:${parseInt(o)+1}`:e})}function x(){if(t.env.NO_COLOR||t.env.FORCE_COLOR==="0"||t.env.FORCE_COLOR==="false")return!1;if(t.env.FORCE_COLOR||t.env.CLICOLOR_FORCE!==void 0)return!0}return D.Command=v,D.useColor=x,D}var Q;function he(){if(Q)return S;Q=1;const{Argument:m}=j(),{Command:u}=ue(),{CommanderError:h,InvalidArgumentError:p}=I(),{Help:t}=X(),{Option:n}=Z();return S.program=new u,S.createCommand=s=>new u(s),S.createOption=(s,l)=>new n(s,l),S.createArgument=(s,l)=>new m(s,l),S.Command=u,S.Option=n,S.Argument=m,S.Help=t,S.CommanderError=h,S.InvalidArgumentError=p,S.InvalidOptionArgumentError=p,S}var ce=he();const de=ae(ce),{program:ye,createCommand:we,createArgument:Ee,createOption:xe,CommanderError:$e,InvalidArgumentError:Se,InvalidOptionArgumentError:ve,Command:pe,Argument:ke,Option:me,Help:He}=de;class fe extends V.EventEmitter{constructor(u,h={}){super(),u.includes("://")||(u=`https://${u}`);const p=new URL(u);this.site=p.pathname==="/"?p.origin:p.href,this.options=h,this.initPromise=null}async initialize(){return this.initPromise===null&&(this.initPromise=(async()=>{try{const u=await V.fetchWithTimeout(this.site,this.options.timeout*1e3);if(!u.ok){this.emit("error",{module:"FeedSeeker",error:`HTTP error while fetching ${this.site}: ${u.status} ${u.statusText}`}),this.content="",this.document={querySelectorAll:()=>[]},this.emit("initialized");return}this.content=await u.text();const{document:h}=oe.parseHTML(this.content);this.document=h,this.emit("initialized")}catch(u){let h=`Failed to fetch ${this.site}`;u.name==="AbortError"?h+=": Request timed out":(h+=`: ${u.message}`,u.cause&&(h+=` (cause: ${u.cause.code||u.cause.message})`)),this.emit("error",{module:"FeedSeeker",error:h,cause:u.cause}),this.content="",this.document={querySelectorAll:()=>[]},this.emit("initialized")}})()),this.initPromise}async metaLinks(){return await this.initialize(),V.metaLinks(this)}async checkAllAnchors(){return await this.initialize(),V.checkAllAnchors(this)}async blindSearch(){return await this.initialize(),V.blindSearch(this)}async deepSearch(){return await this.initialize(),V.deepSearch(this.site,this.options,this)}async startSearch(){const{deepsearchOnly:u,metasearch:h,blindsearch:p,anchorsonly:t,deepsearch:n,all:s,maxFeeds:l}=this.options;if(u)return this.deepSearch();if(h)return this.metaLinks();if(p)return this.blindSearch();if(t)return this.checkAllAnchors();let d=[];const g=[this.metaLinks,this.checkAllAnchors,this.blindSearch];for(const C of g){const y=await C.call(this);if(y&&y.length>0&&(d=d.concat(y),!s&&l>0&&d.length>=l)){d=d.slice(0,l);break}}if(n&&(!l||d.length<l)){const C=await this.deepSearch();C&&C.length>0&&(d=d.concat(C),l>0&&d.length>l&&(d=d.slice(0,l)))}return this.emit("end",{module:"all",feeds:d}),d}}const ge=`___________               .____________              __                 
_   _____/___   ____   __| _/   _____/ ____   ____ |  | __ ___________ 
 |    __)/ __ _/ __  / __ |_____  _/ __ _/ __ |  |/ // __ _  __  |     \\  ___/  ___// /_/ |/          ___/  ___/|    <  ___/|  | /
 ___  / ___  >___  >____ /_______  /___  >___  >__|_ \\___  >__|   
     /      /     /     /       /     /     /     /    /       `;let G=0,T=[],L=!1;function _e(...m){const u=m[0];G=0,process.stdout.write(`Starting ${u.niceName} `)}function Oe(...m){const u=m[0];L?u.feeds.length===0?process.stdout.write(k.styleText("yellow",` No feeds found.
`)):(process.stdout.write(k.styleText("green",` Found ${u.feeds.length} feeds.
`)),console.log(JSON.stringify(u.feeds,null,2)),T=T.concat(u.feeds)):u.feeds.length===0?process.stdout.write(k.styleText("yellow",` No feeds found.
`)):process.stdout.write(k.styleText("green",` Found ${u.feeds.length} feeds.
`))}async function Ce(...m){const u=m[0];if(u.module==="metalinks"&&process.stdout.write("."),(u.module==="blindsearch"||u.module==="anchors")&&"totalCount"in u&&"totalEndpoints"in u){G>0&&process.stdout.write(`\x1B[${G}D`);const h=` (${u.totalCount}/${u.totalEndpoints})`;process.stdout.write(h),G=h.length}if(u.module==="deepSearch"&&"url"in u&&"depth"in u&&"progress"in u){const h=u.progress,p=h.processed||0,t=h.remaining||0,n=p+t;try{const s=new URL(u.url),l=s.hostname,d=s.pathname.length>30?s.pathname.substring(0,27)+"...":s.pathname,g=`${l}${d}`;process.stdout.write(`  [depth:${u.depth} ${p}/${n}] ${g}
`)}catch{process.stdout.write(`  [depth:${u.depth} ${p}/${n}]
`)}}}function be(m,u){const h=new fe(m,u);return h.site=m,h.options=u,h.initializationError=!1,h.on("start",_e),h.on("log",Ce),h.on("end",Oe),h.on("error",(...p)=>{const t=p[0];if(typeof t=="object"&&t!==null&&t.module==="FeedSeeker"&&(h.initializationError=!0),t instanceof Error)console.error(k.styleText("red",`
Error for ${m}: ${t.message}`));else if(typeof t=="object"&&t!==null){const n=t,s=typeof n.error=="string"?n.error:String(t);console.error(k.styleText("red",`
Error for ${m}: ${s}`))}else console.error(k.styleText("red",`
Error for ${m}: ${String(t)}`))}),h}async function Ae(m,u){m.includes("://")||(m=`https://${m}`);const h=be(m,u);if(await h.initialize(),h.initializationError)return[];const p=[];return u.metasearch?p.push(()=>h.metaLinks()):u.anchorsonly?p.push(()=>h.checkAllAnchors()):u.blindsearch?p.push(()=>h.blindSearch()):u.deepsearchOnly?p.push(()=>h.deepSearch()):u.all?p.push(()=>h.metaLinks(),()=>h.checkAllAnchors(),()=>h.blindSearch(),()=>h.deepSearch()):p.push(()=>h.metaLinks(),()=>h.checkAllAnchors(),()=>h.blindSearch(),...u.deepsearch?[()=>h.deepSearch()]:[]),await(async()=>{if(u.all){const s=[];for(const l of p){const d=await l();d.length>0&&s.push(...d)}return s}else{for(const s of p){const l=await s();if(l.length>0)return l}return[]}})()}console.log(`${ge}
`);const H=new pe;H.name("feed-seeker").description("Find RSS, Atom, and JSON feeds on any website with FeedSeeker.");H.command("version").description("Get version").action(async()=>{const u=(await Promise.resolve().then(()=>require("./package-CjU-bUQt.cjs"))).default;process.stdout.write(`${u.version}
`)});H.argument("[site]","The website URL to search for feeds").option("-m, --metasearch","Meta search only").option("-b, --blindsearch","Blind search only").option("-a, --anchorsonly","Anchors search only").option("-d, --deepsearch","Enable deep search").option("--all","Execute all strategies and combine results").option("--deepsearch-only","Deep search only").option("--depth <number>","Depth of deep search",m=>{const u=parseInt(m,10);if(Number.isNaN(u)||u<1)throw new Error("Depth must be a positive number (minimum 1)");return u},3).option("--max-links <number>","Maximum number of links to process during deep search",m=>{const u=parseInt(m,10);if(Number.isNaN(u)||u<1)throw new Error("Max links must be a positive number (minimum 1)");return u},1e3).option("--timeout <seconds>","Timeout for fetch requests in seconds",m=>{const u=parseInt(m,10);if(Number.isNaN(u)||u<1)throw new Error("Timeout must be a positive number (minimum 1 second)");return u},5).option("--keep-query-params","Keep query parameters from the original URL when searching").option("--check-foreign-feeds","Check if foreign domain URLs are feeds (but don't crawl them)").option("--max-errors <number>","Stop after a certain number of errors",m=>{const u=parseInt(m,10);if(Number.isNaN(u)||u<0)throw new Error("Max errors must be a non-negative number");return u},5).option("--max-feeds <number>","Stop search after finding a certain number of feeds",m=>{const u=parseInt(m,10);if(Number.isNaN(u)||u<0)throw new Error("Max feeds must be a non-negative number");return u},0).option("--search-mode <mode>","Search mode for blind search: fast (~25), standard (~100), or full (~350+)","standard").description(`Find feeds for site
`).action(async(m,u)=>{m||(H.help(),process.exit(0));try{u.all&&(L=!0,T=[]),H.feeds=await Ae(m,u)}catch(h){if(u.displayErrors)console.error(`
Error details:`,h);else{const p=h;console.error(k.styleText("red",`
Error: ${p.message}`))}process.exit(1)}});H.addOption(new me("--display-errors","Display errors").hideHelp());H.parseAsync(process.argv).then(()=>{H.feeds!==void 0&&(L&&T.length>0?(console.log(k.styleText("yellow",`
=== All Strategies Complete ===`)),console.log(k.styleText("green",`Total: ${T.length} ${T.length===1?"feed":"feeds"} found from all strategies
`)),console.log(JSON.stringify(T,null,2))):H.feeds.length>0&&console.log(JSON.stringify(H.feeds,null,2)))}).catch(m=>{const u=m;console.error(k.styleText("red",`
Error: ${u.message}`)),process.exit(1)});
